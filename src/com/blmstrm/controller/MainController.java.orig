package com.blmstrm.controller;

import java.util.List;


import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.servlet.ModelAndView;

import com.blmstrm.db.MyEventRepository;
import com.blmstrm.model.MyEvent;

@Controller
public class MainController{
	
	@Autowired
	MyEventRepository eventRepository;
	
	/*Return calendar view*/
	@RequestMapping(value="/",  method = RequestMethod.GET)
	public ModelAndView index(){
		return new ModelAndView("index");
	}

	/*Add event to database through HTTP.POST*/
	@RequestMapping(value="/events",  method = RequestMethod.POST, headers="application/json")
	@ResponseBody
	public MyEvent addEvent(@RequestBody MyEvent newEvent){
		//Add event
		return new MyEvent("Test", "1");
	}

	/*Update event in database through HTTP.PUT*/
	@RequestMapping(value="/events",  method = RequestMethod.PUT, headers="application/json")
	@ResponseBody
	public MyEvent updateEvent(@RequestBody MyEvent currentEvent){
		//Update event
		return new MyEvent("Test", "1");
	}

	//TODO Remove event
	/*Update event in database through HTTP.DELETE*/
<<<<<<< HEAD
	@RequestMapping(value="/events",  method = RequestMethod.DELETE, headers="application/json")
=======
	@RequestMapping(value="/event",  method = RequestMethod.DELETE, consumes = "application/json", produces = "application/json")
>>>>>>> c0f6e72eaf89e479b41b0586f72a92dc29fccb44
	@ResponseBody
	public void removeEvent(@RequestBody MyEvent currentEvent){
		System.out.println("LOG:Removed event!");
	}

	/*Fetch all events from database*/
	@RequestMapping(value="/events", method = RequestMethod.GET)
	@ResponseBody
	public List<MyEvent> getAllEvents(){
		return eventRepository.getAllEvents();
	}

	/*Fetch events from database through HTTP.GET, optionally from date to date.*/
	@RequestMapping(value="/events/{start}/{end}", method = RequestMethod.GET)
	@ResponseBody
	public List<MyEvent> getEventsFromTo(@PathVariable String start, @PathVariable String end){
		//TODO Get events between different dates
	 	return eventRepository.getAllEvents();
	}

	
}

